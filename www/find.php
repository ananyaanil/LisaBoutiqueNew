?php // REGISTER USER include_once('opendb.php'); if (isset($_POST['reg_user'])) { // receive all input values from the form $username = mysqli_real_escape_string($db, $_POST['uname']); $password_1 = mysqli_real_escape_string($db, $_POST['psw']); // form validation: ensure that the form is correctly filled if (empty($username)) { array_push($errors, "Username is required"); } if (empty($password_1)) { array_push($errors, "Password is required"); } $sql="SELECT * FROM login WHERE username='$username'"; $result=mysql_query($sql); // Mysql_num_row is counting table row $count=mysql_num_rows($result); // If result matched $username and $password, table row must be 1 row if($count==1){ $row = mysql_fetch_assoc($result); if ($password_1)) == $row['password']){ session_register("username"); session_register("password"); echo "Login Successful"; return true; } else { echo "Wrong Username or Password"; return false; } } else{ echo "Wrong Username or Password"; return false; } // register user if there are no errors in the form if (count($errors) == 0) { $_SESSION['username'] = $username; $_SESSION['success'] = "You are now logged in"; header('location: index.php'); echo"login successful"; } else{ echo"login failed"; } ?>
